"use strict";angular.module("lx.navigation",[]).provider("$lxNavigation",function(){function a(a){return{title:a.title,route:a.route,app:a.app,state:a.state,roles:a.roles,resources:a.resources}}function b(a,b){if(!b.roles&&!b.resources||!a)return!0;if(b.roles&&!b.resources){if(a.roles)for(var c=0;c<b.roles.length;c++)for(var d=0;d<a.roles.length;d++)if(b.roles[c]===a.roles[d])return!0;return!1}if(a.acl)for(var e=0;e<b.resources.length;e++)for(var f=0;f<a.acl.length;f++)if(b.resources[e]===a.acl[f])return!0;return!1}function c(d,e,f){var g=[];return angular.forEach(d,function(d){if(d.children){var h=c(d.children,e,f),i=a(d);i.children=h,b(f,i)&&g.push(i)}else b(f,d)&&g.push(a(d))}),g}var d={};this.set=function(a){a=a||{},d.navigation=a.navigation},this.$get=["$log",function(a){var b={};return b.getNavigation=function(b){var e=b.currentApp||"main";return d.navigation&&d.navigation[b.navName]?c(d.navigation[b.navName],e,b.user):(d.navigation?a.error('Your defined nav-link-list "'+b.navName+'" is not defined!'):a.info("No Navigation defined. Please define a navigation with the help of the $lxTransportProvider in the config section of your app."),[])},b}]}).directive("lxComNav",["$location","ACTIVE_APP","$http","$templateCache","$compile","$lxNavigation","$log",function(a,b,c,d,e,f,g){return{restrict:"E",replace:!0,scope:{orientation:"@",navName:"@",navTemplatePath:"=",navUser:"="},link:function(h,i){function j(a){angular.forEach(h.menu,function(a){return a.route&&a.state?(g.error('"Please use only one routing element in your navigation. Route or State, not both together!! ',a),i.replaceWith(e('<span style="color:red;padding:15px;">NAV ERROR</span>')(h)),!1):void 0}),i.replaceWith(e(a)(h))}var k='<ul class="nav navbar-nav"><li ng-repeat="item in menu"><div ng-if="item.state" ui-sref-active="active"><a ui-sref="{{item.state}}" ng-show="isActiveApp(item.app) && item.state">{{item.title}}</a></div><div ng-if="!item.state" ng-class="{active: isActive(item.route)}"><a href="{{item.route}}" ng-show="isActiveApp(item.app)">{{item.title}}</a><a href="{{item.route}}" target="_self" ng-show="!isActiveApp(item.app)">{{item.title}}</a></div></li></ul>',l=h.orientation||"horizontal";i.toggleClass("nav-stacked","vertical"===l),h.menu=f.getNavigation({currentApp:b,navName:h.navName,user:h.navUser}),h.navTemplatePath&&h.navTemplatePath.length>3?c.get(h.navTemplatePath,{cache:d}).success(function(a){j("<!doc"!==a.substr(0,5)?a:k)}).error(function(){j(k)}):j(k),h.isActiveApp=function(a){return a===b},h.isActive=function(b){return b===a.path()}}}}]).directive("lxComNavTree",["$route","$location","$templateCache","ACTIVE_APP","$http","$compile","$lxNavigation","$log",function(a,b,c,d,e,f,g,h){return{restrict:"E",replace:!0,scope:{navName:"@",navTemplatePath:"=",navUser:"="},link:function(a,i){function j(b){angular.forEach(a.navList,function(b){return b.route&&b.state?(h.error("Please use only one routing element in your navigation. Route or State, not both together!! ",b),i.replaceWith(f('<span style="color:red;padding:15px;">NAV ERROR</span>')(a)),!1):void 0}),i.replaceWith(f(b)(a))}var k='<ul class="navlist"><li ng-repeat="data in navList" ng-include="\'lx_navigation/standard/nav_tree_inside\'" ng-hide="data.children && data.children.length===0"></li></ul>';c.put("lx_navigation/standard/nav_tree_inside",'<div ng-if="!data.state && data.route" class="list-item" ng-class="{active: isActive(data.route)}"><div class="opensub {{data.hide}}" ng-show="data.children" ng-click="toggleShow(data)"></div><div class="nav-icon {{data.icon}}"></div><a ng-if="data.route && isActiveApp(data.app)" ng-class="{spacer: data.children.length > 0}" ng-href="{{data.route}}"><span>{{data.title}}</span></a><a ng-if="data.route && !isActiveApp(data.app)" ng-class="{spacer: data.children.length > 0}" ng-href="{{data.route}}" target="_self"><span>{{data.title}}</span></a></div><div ng-if="data.state && !data.route" class="list-item"  ui-sref-active="active"><div class="opensub {{data.hide}}" ng-show="data.children" ng-click="toggleShow(data)"></div><div class="nav-icon {{data.icon}}"></div><a ui-sref="{{data.state}}" ng-if="isActiveApp(data.app) && data.state"><span>{{data.title}}</span></a></div><div ng-if="!data.state && !data.route" class="list-item"  ui-sref-active="active"><div class="opensub {{data.hide}}" ng-show="data.children" ng-click="toggleShow(data)"></div><div class="nav-icon {{data.icon}}"></div><a ng-class="{spacer: data.children.length > 0}" ng-click="toggleShow(data);" style="cursor:pointer;"><span>{{data.title}}</span></a></div><ul class="display {{data.hide}}" ng-if="data.children.length"><li ng-repeat="data in data.children" ng-include="\'lx_navigation/standard/nav_tree_inside\'"></li></ul>'),a.app=d,a.openAll=function(c){var d=!1;return angular.forEach(c,function(c){if(c.children){var e=a.openAll(c.children);e&&(c.hide="nav-open")}c.route===b.path()&&(d=!0)}),d},a.toggleShow=function(a){a.hide="nav-close"===a.hide||void 0===a.hide?"nav-open":"nav-close"},a.isActive=function(a){return a===b.path()},a.isActiveApp=function(a){return a===d},a.navList=g.getNavigation({currentApp:d,navName:a.navName,user:a.navUser}),0!==a.navList.length&&(angular.forEach(a.navList,function(b){b.app===a.app&&(b.hide="nav-open")}),a.openAll(a.navList)),a.navTemplatePath&&a.navTemplatePath.length>3?e.get(a.navTemplatePath,{cache:c}).success(function(a){j("<!doc"!==a.substr(0,5)?a:k)}).error(function(){j(k)}):j(k)}}}]);
//# sourceMappingURL=lx_navigation.min.js.map